<xn:head>
    <title>Yublin: Shortcuts for Speed Writing</title>
    <link href="yublin.css" media="screen, projection" rel="stylesheet" type="text/css" />
</xn:head>
<?php
$alphabet = array();
for ($i = ord('a'); $i < ord('z') + 1; $i++) {
    $alphabet[chr($i)] = chr($i);
}

/**
* Returns potential 1- or 2-letter shortcuts for the given word.
*
* @param string $word  the word for which to find a shortcut
* @param array  possible shortcuts, beginning with the best.
*/
function candidate_shortcuts($word) {
    global $alphabet;
    $letters = str_split($word);
    $lastLetter = $letters[count($letters)-1];
    $candidate_shortcuts = $letters;
    $candidate_shortcuts = array_merge($candidate_shortcuts, $alphabet);
    if (count($letters) > 1) { $candidate_shortcuts[] = $letters[0] . $letters[1]; }
    for ($i = 0; $i < count($letters) - 1; $i++) {
        $candidate_shortcuts[] = $letters[$i] . $lastLetter;
        for ($j = $i+1; $j < count($letters); $j++) {
            $candidate_shortcuts[] = $letters[$i] . $letters[$j];
        }
    }
    return $candidate_shortcuts;
}

$shortcut_pool = array();
foreach($alphabet as $letter) {
    $shortcut_pool[$letter] = $letter;
}
foreach($alphabet as $a) {
    foreach($alphabet as $b) {
        $shortcut_pool[$a . $b] = $a . $b;
    }
}

$shortcuts_and_words = array();
if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    $words = explode('|', preg_replace('@\s+@u', '|', $_POST['words']));
    $disallowed_shortcuts = explode('|', preg_replace('@\s+@u', '|', $_POST['disallowed_shortcuts']));
    $shortcut_pool = array_diff($shortcut_pool, $disallowed_shortcuts);
    // Pass 1  [Jon Aquino 2007-06-08]
    foreach ($words as $word) {
        if (strlen($word) <= 2) { unset($words[array_search($word, $words)]); }
    }
    // Pass 2  [Jon Aquino 2007-06-08]
    foreach ($words as $word) {
        foreach (candidate_shortcuts($word) as $candidate_shortcut) {
            if (! $shortcut_pool[$candidate_shortcut]) { continue; }
            if (strlen($word) - strlen($candidate_shortcut) < 2) { continue; }
            unset($shortcut_pool[$candidate_shortcut]);
            $shortcuts_and_words[$candidate_shortcut] = $word;
            break;
        }
    }
    // Pass 3  [Jon Aquino 2007-06-08]
    foreach ($words as $word) {
        if (in_array($word, $shortcuts_and_words)) { continue; }
        if (strlen($word) <= 3) { continue; }  // Shortcuts must save at least 2 characters [Jon Aquino 2007-06-09]
        if (count($shortcut_pool) > 0) {
            $shortcuts_and_words[array_shift($shortcut_pool)] = $word;
            continue;
        }
        // Steal shortcuts from the least common words [Jon Aquino 2007-06-08]
        foreach (array_reverse($words) as $lessCommonWord) {
            if ($lessCommonWord == $word) { break 2; }
            $shortcut = array_search($lessCommonWord, $shortcuts_and_words);
            if (! $shortcut) { continue; }
            $shortcuts_and_words[$shortcut] = $word;
            break;
        }
    } ?>
    <table>
        <thead><tr><th>By frequency</th><th>By word</th><th>By shortcut</th></tr></thead>
        <tr>
            <td>
                <?php
                $top_words = array();
                $words_and_shortcuts = array_flip($shortcuts_and_words);
                foreach ($words as $word) {
                    if (! $words_and_shortcuts[$word]) { continue; }
                    $top_words[$word] = $word;
                    echo xnhtmlentities($words_and_shortcuts[$word]) . ' - ' . xnhtmlentities($word) . '<br />';
                    if (count($top_words) == 620) { break; } // 620 is the cheatsheet size [Jon Aquino 2007-06-09]
                } ?>
            </td>
            <td>
                <?php
                natcasesort($shortcuts_and_words);
                foreach ($shortcuts_and_words as $shortcut => $word) {
                    if (! $top_words[$word]) { continue; }
                    echo xnhtmlentities($word) . ' - ' . xnhtmlentities($shortcut) . '<br />';
                } ?>
            </td>
            <td>
                <?php
                ksort($shortcuts_and_words);
                foreach ($shortcuts_and_words as $shortcut => $word) {
                    if (! $top_words[$word]) { continue; }
                    echo xnhtmlentities($shortcut) . ' - ' . xnhtmlentities($word) . '<br />';
                } ?>
            </td>
        </tr>
    </table>
<?php
} ?>
<h1>Yublin: Shortcuts for Speed Writing</h1>
<form method="POST">
<p>Enter the most common words in your language (highest frequency first):</p>
<!-- Word list from "Top 1000 Words", http://www.bckelk.ukfsn.org/words/uk1000n.html  [Jon Aquino 2007-06-08] -->
<textarea name="words">the
and
to
of
a
I
in
was
he
that
it
his
her
you
as
had
with
for
she
not
at
but
be
my
on
have
him
is
said
me
which
by
so
this
all
from
they
no
were
if
would
or
when
what
there
been
one
could
very
an
who
them
Mr
we
now
more
out
do
are
up
their
your
will
little
than
then
some
into
any
well
much
about
time
know
should
man
did
like
upon
such
never
only
good
how
before
other
see
must
am
own
come
down
say
after
think
made
might
being
Mrs
again
great
two
can
go
over
too
here
came
old
thought
himself
where
our
may
first
way
has
though
without
went
us
away
day
make
these
young
nothing
long
shall
sir
back
don't
house
ever
yet
take
every
hand
most
last
eyes
its
miss
having
off
looked
even
while
dear
look
many
life
still
mind
quite
another
those
just
head
tell
better
always
saw
seemed
put
face
let
took
poor
place
why
done
herself
found
through
same
going
under
enough
soon
home
give
indeed
left
get
once
mother
heard
myself
rather
love
knew
got
lady
room
something
yes
thing
father
perhaps
sure
heart
oh
right
against
three
men
night
people
door
told
round
because
woman
till
felt
between
both
side
seen
morning
began
whom
however
asked
things
part
almost
moment
looking
want
far
hands
gone
world
few
towards
gave
friend
name
best
word
turned
kind
cried
since
anything
next
find
half
hope
called
nor
words
hear
brought
set
each
replied
wish
voice
whole
together
manner
new
believe
course
least
years
answered
among
stood
sat
speak
leave
work
keep
taken
end
less
present
family
often
wife
whether
master
coming
mean
returned
evening
light
money
cannot
whose
boy
days
near
matter
suppose
gentleman
used
says
really
rest
business
full
help
child
sort
passed
lay
small
behind
girl
feel
fire
care
alone
open
person
call
given
I'll
sometimes
making
short
else
large
within
chapter
true
country
times
ask
answer
air
kept
hour
letter
happy
reason
pretty
husband
certain
others
ought
does
known
it's
bed
table
that's
ready
read
already
pleasure
either
means
spoke
taking
friends
talk
hard
walked
turn
strong
thus
yourself
high
along
above
feeling
glad
children
doubt
nature
themselves
black
hardly
town
sense
saying
deal
account
use
white
bad
everything
can't
neither
wanted
mine
close
return
dark
fell
subject
bear
appeared
fear
state
thinking
also
point
therefore
fine
case
doing
held
certainly
walk
lost
question
company
continued
fellow
truth
water
possible
hold
afraid
bring
honour
low
ground
added
five
remember
except
power
seeing
dead
I'm
usual
able
second
arms
late
opinion
window
brother
live
four
none
death
arm
road
hair
sister
entered
sent
married
longer
immediately
god
women
hours
ten
understand
son
horse
wonder
cold
beyond
please
fair
became
sight
met
afterwards
eye
year
show
general
itself
silence
lord
wrong
turning
daughter
stay
forward
O
interest
thoughts
followed
won't
different
opened
several
idea
received
change
laid
strange
nobody
fact
during
feet
tears
run
purpose
character
body
ran
past
order
need
pleased
trouble
whatever
dinner
happened
sitting
getting
there's
besides
soul
ill
early
rose
aunt
hundred
minutes
across
carried
sit
observed
suddenly
creature
conversation
worse
six
quiet
chair
doctor
tone
standing
living
sorry
stand
meet
instead
wished
ah
lived
try
red
smile
sound
expected
silent
common
meant
tried
until
mouth
distance
occasion
cut
marry
likely
length
story
visit
deep
seems
street
remained
become
led
speaking
natural
giving
further
struck
week
loved
drew
seem
church
knows
object
ladies
marriage
book
appearance
pay
I've
obliged
particular
pass
thank
form
knowing
lips
knowledge
former
blood
sake
fortune
necessary
presence
feelings
corner
beautiful
talking
spirit
ago
foot
circumstances
wind
presently
comes
attention
wait
play
easy
real
clear
worth
cause
send
spirits
chance
didn't
view
pleasant
party
beginning
horses
stopped
notice
duty
he's
age
figure
leaving
sleep
entirely
twenty
fall
promise
months
broken
heavy
secret
thousand
happiness
comfort
minute
act
human
fancy
strength
showed
pounds
nearly
probably
captain
piece
school
write
laughed
reached
repeated
walking
father's
heaven
beauty
shook
sun
waiting
moved
bit
desire
news
front
effect
laugh
uncle
fit
miles
handsome
caught
hat
regard
gentlemen
supposed
easily
impossible
glass
resolved
grew
consider
green
considered
unless
stop
forth
expect
perfectly
altogether
surprise
sudden
free
exactly
grave
carriage
believed
service
angry
putting
carry
everybody
mentioned
looks
scarcely
society
affection
exclaimed
dress
die
earth
latter
garden
step
perfect
countenance
liked
dare
pain
companion
journey
paper
opportunity
makes
honest
arrived
you'll
bright
pity
directly
cry
trust
fast
ye
warm
danger
trees
breakfast
rich
engaged
proper
talked
respect
fixed
hill
wall
determined
wild
shut
top
plain
scene
sweet
especially
public
acquaintance
forget
history
pale
pray
books
afternoon
man's
otherwise
mention
position
speech
gate
'em
boys
yours
drink
slowly
broke
clothes
fond
pride
watch
sooner
settled
paid
reply
tea
lie
running
died
gentle
particularly
allowed
outside
placed
joy
hearing
note
condition
follow
begin
neck
serious
hurt
kindness
mere
farther
changed
o'clock
passing
girls
force
situation
greater
expression
eat
reading
spoken
raised
anybody
started
following
although
sea
proud
future
quick
safe
temper
laughing
ears
difficulty
meaning
servant
sad
advantage
appear
offer
breath
opposite
number
miserable
law
rising
favour
save
twice
single
blue
noise
stone
mistress
surprised
allow
spot
burst
keeping
line
understood
court
finding
direction
anxious
pocket
around
conduct
loss
fresh
below
hall
satisfaction
land
telling
passion
floor
break
lying
waited
closed
meeting
trying
seat
king
confidence
offered
stranger
somebody
matters
noble
pardon
private
sharp
evil
weeks
justice
hot
cast
letters
youth
lives
health
finished
hoped
holding
touch
spite
delight
bound
consequence
rain
wouldn't
third
hung
ways
weather
written
difference
kitchen
she's
mother's
persons
quarter
promised
hopes
brown
nay
seven
simple
wood
beside
middle
ashamed
lose
dreadful
move
generally
cousin
surely
satisfied
bent
shoulder
art
field
quickly
thrown
tired
share
pair
to-morrow
aware
colour
writing
whenever
quietly
fool
forced
touched
smiling
taste
dog
spent
steps
worst
legs
watched
ay
thee
eight
worthy
wrote
manners
proceeded
frightened
somewhat
born
greatest
charge
degree
shame
places
ma'am
couldn't
tongue
according
box
wine
filled
servants
calling
fallen
supper</textarea>
<p>Enter disallowed shortcuts (1- and 2-letter combinations that are already words or abbreviations in your language):</p>
<textarea name="disallowed_shortcuts">a ah am an as at be by do eg fk go he hi hm ie if in is it me mr my no of oh ok on or re so to uh um up us vs we</textarea>
<p><input type="submit" value="Generate Shortcuts" /></p>
</form>
